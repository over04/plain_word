FROM alpine:latest
ARG TARGETARCH
RUN apk add --no-cache sqlite-libs ca-certificates
WORKDIR /app
COPY dist/${TARGETARCH}/server ./server
COPY dist/static ./static
RUN chmod +x ./server && mkdir -p /app/data
ENV DATABASE_URL=sqlite:./data/plain_word.db?mode=rwc
ENV SERVER_HOST=0.0.0.0
ENV SERVER_PORT=3000
EXPOSE 3000
VOLUME ["/app/data"]
CMD ["./server"]